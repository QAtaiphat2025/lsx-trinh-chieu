<script>
  const apiUrl = "https://script.google.com/macros/s/AKfycbxyTBgAkwZZ546HY8GsatqY9p229gSMytQPzro4MhoXZc6M4Mafz36ApGgT8169c83jiw/exec";

  async function loadData() {
    try {
      const response = await fetch(apiUrl);
      const data = await response.json();

      const table1 = document.getElementById("table1");
      const table2 = document.getElementById("table2");
      table1.innerHTML = "";
      table2.innerHTML = "";

      if (!Array.isArray(data) || data.length === 0) {
        table1.innerHTML = "<tr><td>Không có dữ liệu</td></tr>";
        table2.innerHTML = "<tr><td>Không có dữ liệu</td></tr>";
        return;
      }

      // Các cột cần hiển thị cho từng khu vực
      const columns1 = [
        "Loại phôi chuẩn bị sản xuất",
        "Số lượng phôi yêu cầu",
        "Ngày lệnh",
        "kích thước phôi",
        "Loại giấy",
        "Định lượng",
        "Khổ",
        "Thứ tự sản xuất"
      ];

      const columns2 = [
        "Loại phôi đã hoàn thành",
        "Số lượng phôi thực tế",
        "Ngày giờ hoàn thành",
        "Nhiệt giấy đầu ra lô sóng",
        "Nhiệt giấy đầu vào máy keo",
        "Nhiệt phôi đầu ra khỏi giàn chắn"
      ];

      function renderTable(container, columns) {
        let html = "<thead><tr>" + columns.map(c => `<th>${c}</th>`).join("") + "</tr></thead><tbody>";
        data.forEach(row => {
          html += "<tr>" + columns.map(c => `<td>${row[c] ?? ""}</td>`).join("") + "</tr>";
        });
        html += "</tbody>";
        container.innerHTML = html;
      }

      renderTable(table1, columns1);
      renderTable(table2, columns2);

    } catch (error) {
      console.error("Lỗi khi tải dữ liệu:", error);
    }
  }

  loadData();
  setInterval(loadData, 60000);
</script>
